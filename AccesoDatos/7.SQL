CLEAR SCR;
CREATE TYPE TIPO_NOMBRES_DEP IS VARRAY(7) OF VARCHAR(30);
/
DROP TABLE DEPARTAMENTOS;
CREATE TABLE DEPARTAMENTOS (
REGION VARCHAR(25),
NOMBRES_DEP TIPO_NOMBRES_DEP
);
/
--Insertar valores en la tabla
INSERT INTO DEPARTAMENTOS VALUES ('EUROPA',TIPO_NOMBRES_DEP('SHIPPING','SALES','FINANCES'));
INSERT INTO DEPARTAMENTOS VALUES ('AMERICA',TIPO_NOMBRES_DEP('SALES','FINANCES','SHIPPING'));
INSERT INTO DEPARTAMENTOS VALUES ('ASIA',TIPO_NOMBRES_DEP('SHIPPING','FINANCES','SALES','PAYROLL'));
SELECT * FROM DEPARTAMENTOS;

DECLARE

	V_NOMBRES TIPO_NOMBRES_DEP := TIPO_NOMBRES_DEP('BENEFITS','ADVERTISING','CONTRACTING','EXECUTIVE','MARKETING');
	V_NOMBRES2 TIPO_NOMBRES_DEP;

BEGIN
	UPDATE DEPARTAMENTOS SET NOMBRES_DEP = V_NOMBRES WHERE REGION='EUROPA';
	SELECT NOMBRES_DEP INTO V_NOMBRES2 FROM DEPARTAMENTOS WHERE REGION='EUROPA';
	
	FOR I IN V_NOMBRES2.FIRST .. V_NOMBRES2.LAST LOOP
		DBMS_OUTPUT.PUT_LINE('DEPARTAMENTOS: '||V_NOMBRES2(I));
	END LOOP;
END;
/

DECLARE

	CURSOR C1 IS SELECT * FROM DEPARTAMENTOS;
	V_REGION VARCHAR(25);
	V_NOMBRES TIPO_NOMBRES_DEP;
BEGIN
	
	OPEN C1;
	LOOP
	FETCH C1 INTO V_REGION,V_NOMBRES;
		EXIT WHEN C1%NOTFOUND;
		FOR I IN V_NOMBRES.FIRST .. V_NOMBRES.LAST LOOP
			DBMS_OUTPUT.PUT_LINE('DEPARTAMENTO: '||'('||I||')'||V_NOMBRES(I));
		END LOOP;
	END LOOP;
END;
/

DECLARE 

	CURSOR C2 IS SELECT * FROM DEPARTAMENTOS;

BEGIN

	DBMS_OUTPUT.PUT_LINE('SE PROCEDE A MOSTRAR CON 2 FOR ');
	DBMS_OUTPUT.PUT_LINE(' ------------------------------------------- ');
	FOR I IN C2 LOOP
		DBMS_OUTPUT.PUT_LINE('REGION: '||I.REGION);
		FOR J IN I.NOMBRES_DEP.FIRST .. I.NOMBRES_DEP.LAST LOOP
			DBMS_OUTPUT.PUT_LINE('DEPARTAMENTO: '||'('||J||')'||I.NOMBRES_DEP(J));
		END LOOP;
	END LOOP;

END;
/